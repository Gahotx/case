"use strict";(self["webpackChunkhmtt"]=self["webpackChunkhmtt"]||[]).push([[281],{3017:function(t,s,i){i.r(s),i.d(s,{default:function(){return u}});var e=function(){var t=this,s=t._self._c;return s("div",[s("div",{staticClass:"search-header"},[s("van-icon",{staticClass:"goback",attrs:{name:"arrow-left",color:"white",size:"0.48rem"},on:{click:function(s){return t.$router.back()}}}),s("van-search",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{placeholder:"请输入搜索关键词",background:"#007BFF",shape:"round"},on:{input:t.inputFn,search:t.searchFn},model:{value:t.kw,callback:function(s){t.kw="string"===typeof s?s.trim():s},expression:"kw"}})],1),0!==t.kw.length?s("div",{staticClass:"sugg-list"},t._l(t.suggestionsList,(function(i,e){return s("div",{key:e,staticClass:"sugg-item",domProps:{innerHTML:t._s(t.highlightFn(i,t.kw))},on:{click:function(s){return t.suggFn(i)}}})})),0):s("div",{staticClass:"search-history"},[s("van-cell",{attrs:{title:"搜索历史"},scopedSlots:t._u([{key:"right-icon",fn:function(){return[s("van-icon",{staticClass:"search-icon",attrs:{name:"delete"},on:{click:t.delHis}})]},proxy:!0}])}),s("div",{staticClass:"history-list"},t._l(t.history,(function(i,e){return s("span",{key:e,staticClass:"history-item",on:{click:function(s){return t.goHistory(i)}}},[t._v(" "+t._s(i)+" ")])})),0)],1)])},n=[],r=i(586),a={name:"SearchPage",data(){return{kw:"",timer:null,suggestionsList:[],history:JSON.parse(localStorage.getItem("history"))||[]}},methods:{inputFn(){clearTimeout(this.timer),0===this.kw.length?this.suggestionsList=[]:this.timer=setTimeout((async()=>{const t=await(0,r.vt)({prefix:this.kw});null===t.data.data.options[0]?this.suggestionsList=[]:this.suggestionsList=t.data.data.options}),300)},highlightFn(t,s){if(0!==this.suggestionsList.length){const i=new RegExp(s,"ig");return t.replace(i,`<span style="color:red">${s}</span>`)}},searchFn(){0!==this.kw.length&&(this.history.push(this.kw),setTimeout((()=>{this.$router.push({path:`/search/${this.kw}`})}),0))},goHistory(t){this.$router.push({path:`/search/${t}`})},suggFn(t){this.history.push(t),setTimeout((()=>{this.$router.push({path:`/search/${t}`})}),0)},delHis(){this.history=[]}},watch:{history:{deep:!0,immediate:!0,handler(){const t=new Set(this.history),s=[...t];localStorage.setItem("history",JSON.stringify(s))}}}},o=a,h=i(1001),c=(0,h.Z)(o,e,n,!1,null,"6bcf2ed3",null),u=c.exports}}]);
//# sourceMappingURL=SearchPage.35c000d6.js.map